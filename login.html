<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="https://lh3.googleusercontent.com/d/1CWImzia2Z8LdK-VxeMKK22oa7387Ktwj" type="image/x-icon">
    <title>Mozart Plus+ | Iniciar Sesi칩n</title>
    
    <meta name="google-signin-client_id" content="613538890545-o4p4ft7oji6uhimgh0inqn5l5cgv1gnm.apps.googleusercontent.com">
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
     <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Karla:wght@400;500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">

    <style>
        /* --- VARIABLES (Tema Piano Quest Pro) --- */
        :root {
            --bg-body: #f8f9fa;
            --text-primary: #1a1a1a;
            --text-secondary: #6b7280;
            --surface: #ffffff;
            --border: #e5e7eb;
            --radius-lg: 12px;
            --radius-sm: 6px;
            --font-sans: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            
            /* Input overrides */
            --input-bg: #ffffff;
            --input-border: #e5e7eb;
            --input-focus: #1a1a1a; /* Negro al enfocar */
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-sans);
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .container-fluid, .row {
            height: 100vh;
            min-height: 700px;
        }

        /* --- Intro Section (Panel Izquierdo) --- */
        .intro-section {
            background-size: cover;
            background-position: center;
            padding: 60px 80px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            position: relative;
            color: #ffffff;
        }
        
        /* Overlay oscuro para texto blanco */
        .intro-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            /* Degradado oscuro para que el texto resalte */
            background: linear-gradient(to top, rgba(0,0,0,0.2), rgba(0,0,0,0.3));
            z-index: 1;
        }
        
        .brand-wrapper, .intro-content-wrapper {
            position: relative;
            z-index: 2;
        }

        .intro-section .brand-wrapper h1 {
               font-family: 'Poppins', sans-serif !important;
            font-size: 28px !important;
            font-weight: 700;
            display: flex; align-items: center; gap: 10px;
            color: #fff;
        }
       

        .intro-title {
            font-size: 3.5rem;
            font-weight: 600;
            line-height: 1.1;
            letter-spacing: -1.5px;
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 2px 5px rgba(0,0,0,0.4);
        }

        .intro-text {
            font-size: 1.1rem;
            opacity: 0.95;
            margin-bottom: 30px;
            font-weight: 400;
            text-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }

        .btn-read-more {
            background: transparent;
            color: #fff;
            font-weight: 500;
            padding: 12px 28px;
            border-radius: var(--radius-sm);
            text-transform: none;
            font-size: 14px;
            transition: transform 0.2s;
            border: 1px solid #fff;
            width: fit-content;
              text-decoration: none;
        }
        .btn-read-more:hover {
            transform: translateY(-2px);
            background: #ffffff;
            color: var(--text-primary);
        }

        /* --- Form Section (Panel Derecho) --- */
        .form-section {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-body);
        }

        .login-card {
            width: 100%;
            max-width: 400px;
            background-color: var(--surface);
            padding: 40px;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }
        
        .form-section-content {
            display: none; /* Se maneja con JS */
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo-img {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px auto;
            display: block;
            border-radius: 12px;
        }

        .form-title {
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--text-primary);
        }
        
        /* Inputs Estilo Minimalista */
        .form-group { margin-bottom: 20px; position: relative; }
        
        .form-control, .custom-select {
            height: 48px;
            border: 1px solid var(--input-border);
            border-radius: var(--radius-sm);
            padding: 0 38px 0 40px;
            font-size: 14px;
            color: var(--text-primary);
            background-color: var(--surface);
            transition: all 0.2s ease;
        }
        
        .form-control:focus, .custom-select:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 0 0 1px var(--text-primary);
        }

        .form-group .form-icon {
            position: absolute;
            top: 50%; transform: translateY(-50%);
            left: 12px;
            color: var(--text-secondary);
            font-size: 18px;
        }
        .input-group input { padding-left: 20px; }

        /* --- BUTTONS --- */
        .login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 12px;
            margin-bottom: 12px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .login-btn-email, #sign {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .login-btn-email:hover, #sign:hover {
            transform: translateY(-2px);
            border-color: var(--text-secondary);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            background: var(--surface);
        }

        /* Bot칩n Primario (Negro S칩lido) */
        .btn-primary {
            background: var(--text-primary);
            color: var(--bg-body);
            border: 1px solid var(--text-primary);
        }
        
        .btn-primary:hover {
            background: #000;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .back-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid transparent;
        }
        .back-btn:hover {
            color: var(--text-primary);
            background: var(--bg-body);
        }

        .login-btn-icon { font-size: 18px; margin-right: 8px; }
        .ri-whatsapp-fill { color: #25d366; } 

        /* Links */
        .signup-link {
            text-align: center;
            margin-top: 24px;
            font-size: 13px;
            color: var(--text-secondary);
        }
        .signup-link a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }
        .signup-link a:hover { border-bottom-color: var(--text-primary); }

        /* Footer Links */
        .footer-link {
            text-align: center;
            margin-top: 30px;
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }
        .footer-link a {
            color: var(--text-secondary);
            font-size: 12px;
            margin: 0 10px;
            text-decoration: none;
            font-family: var(--font-mono);
        }
        .footer-link a:hover { color: var(--text-primary); }

        /* Alerts */
        .alert {
            border-radius: var(--radius-sm);
            font-size: 13px;
            border: none;
        }
        .alert-danger {
            background-color: #fef2f2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        .alert-success {
            background-color: #f0fdf4;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        .alert-info {
            background-color: #eff6ff;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        /* Loader */
        .showbox { display: flex; justify-content: center; align-items: center; margin: 20px 0; }
        .loader { position: relative; margin: 0px auto; width: 50px; } /* Ajuste de tama침o */
        .loader:before { content: ""; display: block; padding-top: 100%; }
        .circular { animation: rotate 2s linear infinite; height: 100%; transform-origin: center center; width: 100%; position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: auto; }
        .path { stroke-dasharray: 1, 200; stroke-dashoffset: 0; animation: dash 1.5s ease-in-out infinite; stroke: var(--text-primary); stroke-linecap: round; }
        @keyframes rotate { 100% { transform: rotate(360deg); } }
        @keyframes dash { 
            0% { stroke-dasharray: 1, 200; stroke-dashoffset: 0; } 
            50% { stroke-dasharray: 89, 200; stroke-dashoffset: -35px; } 
            100% { stroke-dasharray: 89, 200; stroke-dashoffset: -124px; } 
        }

        /* Mobile Download & Responsive */
        .mobile-download-section { display: none; text-align: center; margin-top: 25px; padding-top: 20px; }
        .btn-download-app {
            display: flex; align-items: center; justify-content: center; width: 100%;
            padding: 12px; font-size: 15px; font-weight: 600; text-decoration: none !important;
            color: #fff; background-color: var(--text-primary); /* Negro ahora */
            border-radius: var(--radius-sm); transition: all 0.3s ease;
        }
        .download-divider {
            font-size: 13px; color: var(--text-secondary);
            margin-top: 20px; margin-bottom: 20px;
            display: flex; align-items: center; text-transform: uppercase; letter-spacing: 1px;
        }
        .download-divider::before, .download-divider::after {
            content: ""; flex: 1; border-bottom: 1px solid var(--border);
        }
        .download-divider::before { margin-right: 10px; }
        .download-divider::after { margin-left: 10px; }

        @media (max-width: 991px) {
            .intro-section { display: none; }
            .form-section { padding: 20px; background: #fff; }
            .login-card { padding: 0; box-shadow: none; border: none; }
            .row { min-height: auto; height: auto; }
            .mobile-download-section { display: block; }
        }
    </style>
</head>
<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-7 intro-section">
            <div class="brand-wrapper">
                <h1>Mozart Plus+</h1>
            </div>
            <div class="intro-content-wrapper">
                <h1 class="intro-title">Aprende piano a tu propio ritmo</h1>
                <p class="intro-text">Con Mozart Plus+, accede a lecciones interactivas cuando quieras y progresa sin l칤mites.</p>
                <a href="https://www.mozartacademy.mx" class="btn btn-read-more">M치s informaci칩n</a>
            </div>
        </div>
        
        <div class="col-lg-5 form-section">
            <div class="login-card">
                
                <div id="login-options" class="form-section-content">
                    <img src="https://lh3.googleusercontent.com/d/1TxanAOdc5RxLFzOLqMOPTX1_sz_uEDnS=s400" class="logo-img">
                    <h4 class="form-title">Inicia sesi칩n</h4>

                     <div class="preloader showbox" style="display: none">
                        <div class="loader">
                            <svg class="circular" viewbox="25 25 50 50">
                              <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle>
                            </svg>
                          </div>
                      </div> 

                    <div class="buttons-container">
                         <div class="mobile-download-section">  
                             <button class="btn-download-app" onclick="installApp()">   
                                  <i class="ri-google-play-fill" style="margin-right: 10px;"></i> Descargar App
                             </button>
                             <p class="download-divider">o inicia sesi칩n</p>
                         </div>

                        <div id="g_id_onload" data-client_id="613538890545-o4p4ft7oji6uhimgh0inqn5l5cgv1gnm.apps.googleusercontent.com" data-context="signup" data-ux_mode="popup" data-callback="handleCredentialResponse" data-auto_prompt="true"></div>
                        <div id="sign" class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="outline" data-text="signin_with" data-size="large" data-logo_alignment="left" data-width="338" onclick="showLoader()"></div>
                        
                        <button class="login-btn login-btn-email" onclick="showMailLogin()" style="margin-top: 15px;">
                            <i class="ri-mail-line login-btn-icon"></i> Acceder con email
                        </button>
                        <button class="login-btn login-btn-email" onclick="showWhatsappLogin()">
                            <i class="ri-whatsapp-fill login-btn-icon"></i> Acceder con WhatsApp
                        </button>

                         <div class="signup-link">
                            <p>쯅o tienes cuenta? <a href="#" onclick="showSignupForm()">Reg칤strate</a></p>
                        </div>
                    </div>
                </div>

                <section id="whatsapp-login" class="form-section-content">
                    <h4 class="form-title">Inicia con WhatsApp</h4>
                    <div id="WA-error" class="alert alert-danger" style="display: none;">N칰mero no registrado.</div>
                    <div id="WA-error2" class="alert alert-danger" style="display: none;">C칩digo incorrecto.</div>
                    <div id="WA-success" class="alert alert-info" style="display: none;">C칩digo enviado a tu WhatsApp.</div>
                    
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <select id="country-code" class="custom-select" style="border-top-right-radius: 0; border-bottom-right-radius: 0;">
                                <option value="+52">游쓇릖 +52</option><option value="+1">游쥟릖 +1</option><option value="+1">游뻟릖 +1</option><option value="+57">游뻟릖 +57</option><option value="+54">游뷣릖 +54</option>
                            </select>
                        </div>
                        <input type="text" inputmode="numeric" maxlength="10" pattern="[0-9]*" class="form-control" id="phone-login" autocomplete="off" placeholder="N칰mero de tel칠fono">
                    </div>
                    
                    <div class="form-group">
                        <i class="ri-key-2-line form-icon"></i>
                        <input type="text" id="WAcode" class="form-control" placeholder="Ingresa el c칩digo" style="display: none;">
                    </div>
                    <div id="mailVar" mail="" style="display:none"></div>

                    <button class="login-btn btn-primary" onclick="WAlogin(this)">Enviar mensaje</button>
                    <button class="back-btn login-btn" onclick="showLoginOptions()">Atr치s</button>
                </section>

                <section id="maillogin" class="form-section-content">
                    <h4 class="form-title">Acceder con email</h4>
                    <div id="Mail-error" class="alert alert-danger" style="display: none;">Cuenta no registrada o contrase침a incorrecta.</div>
                    <div id="Mail-success" class="alert alert-success" style="display: none;">춰Registro exitoso! Revisa tu correo.</div>
                    
                    <div class="form-group">
                        <i class="ri-mail-line form-icon"></i>
                        <input type="email" id="email-login" class="form-control" placeholder="Ingresa tu email">
                      </div>
                    <div class="form-group">
                        <i class="ri-lock-password-line form-icon"></i>
                        <input type="password" id="password-login" class="form-control" placeholder="Ingresa tu password">
                    </div>
                    
                    <button class="login-btn btn-primary" onclick="Maillogin(this)">Iniciar sesi칩n</button>
                    <button class="back-btn login-btn" onclick="showLoginOptions()">Atr치s</button>
                </section>

                <section id="signupform" class="form-section-content">
                    <h4 class="form-title">Crear una cuenta</h4>
                    <div id="User-error" class="alert alert-danger" style="display: none">Tu correo ya est치 registrado.</div>

                    <div class="form-group">
                         <i class="ri-user-line form-icon"></i>
                        <input type="text" id="name-register" class="form-control" placeholder="Ingresa tu nombre completo">
                    </div>
                    <div class="form-group">
                         <i class="ri-mail-line form-icon"></i>
                        <input type="email" id="mail-register" class="form-control" placeholder="Ingresa tu email">
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                             <select id="country-code-register" class="custom-select" style="border-top-right-radius: 0; border-bottom-right-radius: 0;">
                                <option value="+52">游쓇릖 +52</option><option value="+1">游쥟릖 +1</option><option value="+1">游뻟릖 +1</option><option value="+57">游뻟릖 +57</option><option value="+54">游뷣릖 +54</option>
                            </select>
                        </div>
                        <input type="text" id="phone-register" inputmode="numeric" maxlength="10" pattern="[0-9]*" class="form-control" autocomplete="off" placeholder="N칰mero de tel칠fono">
                    </div>
                    
                    <button class="login-btn btn-primary" onclick="registration(this)">Registrarse</button>
                    <button class="back-btn login-btn" onclick="showLoginOptions()">Atr치s</button>
                </section>

                 <div class="footer-link">
                    <div class="d-flex justify-content-center">
                        <a href="https://www.instagram.com/mozartplus_/">@mozartplus</a>
                        <a href="https://wa.me/5215577676657">Contacto</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="iosInstallModal" tabindex="-1" role="dialog" aria-labelledby="iosModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content" style="border-radius: 12px; border:none;">
      <div class="modal-header">
        <h5 class="modal-title" id="iosModalLabel" style="font-weight: 600;">Instalar en iOS</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">칑</span>
        </button>
      </div>
      <div class="modal-body text-center">
        <p>Para instalar la app en tu iPhone o iPad:</p>
        <p class="mb-2">1. Presiona el 칤cono de <strong>Compartir <i class="ri-share-2-line" style="vertical-align: middle; font-size: 1.2rem;"></i></strong> en la barra de Safari.</p>
        <p class="mb-3">2. Desliza hacia arriba y selecciona <br><strong>"Agregar a inicio <i class="ri-add-box-line" style="vertical-align: middle; font-size: 1.2rem;"></i>"</strong> .</p>
      </div>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
<script>

    function showSection(sectionId) {
        // Ocultar todas las secciones
        document.querySelectorAll('.form-section-content').forEach(section => {
            section.style.display = 'none';
        });
        
        const sectionToShow = document.getElementById(sectionId);
        if (sectionToShow) {
            sectionToShow.style.display = 'block';
        }
        document.querySelectorAll('.alert').forEach(alert => alert.style.display = 'none');
    }

    function showWhatsappLogin() { showSection('whatsapp-login'); }
    function showMailLogin() { showSection('maillogin'); }
    function showSignupForm() { showSection('signupform'); }
    function showLoginOptions() { showSection('login-options'); }

    // --- L칍GICA DE LOGIN ORIGINAL ---
    function handleCredentialResponse(response) {
      const responsePayload = decodeJwtResponse(response.credential);
      var name = responsePayload.name;
      var photo = responsePayload.picture;
      var email = responsePayload.email;
      showLoader();
      var api = "https://script.google.com/macros/s/AKfycbxXD35z5FSf_m_dwBt5qcBwWq2L7IDc7KBrYGfix6hUa4kvJ1TFpjU82NltFXezUroGgQ/exec";
      var validationData = {
        redirect: "follow",
        method: "POST",
        headers: { "Content-Type": "text/plain;charset=utf-8" },
        body: JSON.stringify({ action: "validateGoogleUser", name: name, email: email, photo: photo })
      };
      fetch(api, validationData)
        .then(response => response.text())
        .then(res => {
          var validation = JSON.parse(res);
          if (validation.status == "success") {
            localStorage.setItem('MStoken', validation.token);
            window.location.href = 'https://www.mozart-app.com/main';
          } else {
            alert('Error, intenta otro m칠todo de inicio de sesi칩n');
          }
        })
    }

    function decodeJwtResponse(data) {
      let tokens = data.split(".");
      return JSON.parse(atob(tokens[1]))
    }

    function showLoader() {
      $('.preloader').css({ 'display': 'block' });
      $('.buttons-container').css({ 'display': 'none' });
      setTimeout(function() {
        $('.preloader').css({ 'display': 'none' });
        $('.buttons-container').css({ 'display': 'block' });
      }, 7000);
    }

    function WAlogin(button) {
      var phone = $('#phone-login').val();
      var code = $('#WAcode').val();
      var mail = $("#mailVar").attr("mail");
      var $button = $(button);
      
      if (phone != "") {
        $button.html("<i class='ri-loader-4-line ri-spin'></i> Cargando...");
        var api = "https://script.google.com/macros/s/AKfycbxXD35z5FSf_m_dwBt5qcBwWq2L7IDc7KBrYGfix6hUa4kvJ1TFpjU82NltFXezUroGgQ/exec";
        if (mail == "") {
          var validationData = {
            redirect: "follow",
            method: "POST",
            headers: { "Content-Type": "text/plain;charset=utf-8" },
            body: JSON.stringify({ action: "WArequest", phone: phone })
          };
          fetch(api, validationData)
            .then(response => response.text())
            .then(res => {
              var validation = JSON.parse(res);
              if (validation.status == "success") {
                $("#mailVar").attr("mail", validation.mail);
                $('#WAcode').show();
                $('#WA-success').show().delay(5000).fadeOut();
                $button.html("Iniciar sesi칩n");
              } else {
                $('#WA-error').show().delay(5000).fadeOut();
                $button.html("Enviar mensaje");
              }
            });
        } else {
          var validationData = {
            redirect: "follow",
            method: "POST",
            headers: { "Content-Type": "text/plain;charset=utf-8" },
            body: JSON.stringify({ action: "validateUser", email: mail, password: code })
          };
          fetch(api, validationData)
            .then(response => response.text())
            .then(res => {
              var validation = JSON.parse(res);
              if (validation.status == "success") {
                localStorage.setItem('MStoken', validation.token);
                window.location.href = 'https://www.mozart-app.com/main';
                $('#WAcode').hide();
                $('#phone-login').val("");
              } else {
                $('#WA-error2').show().delay(5000).fadeOut();
              }
              $('#WAcode').val("");
              $button.html("Iniciar sesi칩n");
            });
        }
      } else {
        alert("Ingresa tu n칰mero");
      }
    }
    
    function Maillogin(button) {
      var email = $('#email-login').val();
      var password = $('#password-login').val();
      var $button = $(button);
      
      if (email != "" && password != "") {
        $button.html("<i class='ri-loader-4-line ri-spin'></i> Cargando...");
        var api = "https://script.google.com/macros/s/AKfycbxXD35z5FSf_m_dwBt5qcBwWq2L7IDc7KBrYGfix6hUa4kvJ1TFpjU82NltFXezUroGgQ/exec";
        var validationData = {
          redirect: "follow",
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify({ action: "validateUser", email: email, password: password })
        };
        fetch(api, validationData)
          .then(response => response.text())
          .then(res => {
            var validation = JSON.parse(res);
            if (validation.status == "success") {
              localStorage.setItem('MStoken', validation.token);
              window.location.href = 'https://www.mozart-app.com/main';
            } else {
              $('#Mail-error').show().delay(5000).fadeOut();
            }
            $('#email-login').val("");
            $('#password-login').val("");
            $button.html("Iniciar sesi칩n");
          });
      } else {
        alert("Ingresa tus datos de acceso");
      }
    }

    function registration(button) {
      var name = $('#name-register').val();
      var email = $('#mail-register').val();
      var phone = $('#country-code-register').val() + $('#phone-register').val();
      var $button = $(button);

      if (name != "" && email != "" && phone != "") {
        $button.html("<i class='ri-loader-4-line ri-spin'></i> Cargando...");
        var api = "https://script.google.com/macros/s/AKfycbxXD35z5FSf_m_dwBt5qcBwWq2L7IDc7KBrYGfix6hUa4kvJ1TFpjU82NltFXezUroGgQ/exec";
        var validationData = {
          redirect: "follow",
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify({ action: "registration", name: name, email: email, phone: phone })
        };
        fetch(api, validationData)
          .then(response => response.text())
          .then(res => {
            var validation = JSON.parse(res);
            if (validation.status == "success") {
              showMailLogin();
              $('#Mail-success').show().delay(4000).fadeOut();
            } else if (validation.status == "registered") {
              $('#User-error').show().delay(4000).fadeOut();
            } else {
              alert("Ocurri칩 un error, contacta a soporte");
            }
            $('#name-register, #mail-register, #phone-register').val("");
            $button.html("Registrarse");
          });
      } else {
        alert("Rellena todos los campos");
      }
    }

    $(window).on('load', function() {
      showLoginOptions();
      var storedToken = localStorage.getItem('MStoken');
      if (storedToken) {
        window.location.href = 'https://www.mozart-app.com/main'
      }
    });

    // --- SCRIPT FONDO ACTUALIZADO (DARK GRADIENT) ---
    $(function() {
        var images = [
            'https://lh3.googleusercontent.com/d/1XUHZMWjkiD1dBveaoEYSTY_Zd7lOi63t',
            'https://lh3.googleusercontent.com/d/1574yKLK-x78N7AYfRtLRpUVv7ihC3dui=s1000',
            'https://lh3.googleusercontent.com/d/1PoQXBg8DCvKCAXx0l-kwciDR_XMyyytg',
        ];

        var randomIndex = Math.floor(Math.random() * images.length);
        var randomImage = images[randomIndex];
        
        // APLICANDO EL DEGRADADO OSCURO (Estilo Landing Page)
        $('.intro-section').css('background-image', 
            'linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url(' + randomImage + ')'
        );
        
        if (window.matchMedia('(max-width: 891px)').matches) {
            $('#sign').attr('data-width', '300');
        }
    });

    // --- PWA LOGIC ---
    let deferredPrompt;
    const isAndroid = /Android/i.test(navigator.userAgent);
    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').then(function (registration) {
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      }, function (err) {
        console.log('ServiceWorker registration failed: ', err);
      });
    }

    if ('setAppBadge' in navigator) {
      navigator.setAppBadge(5).catch((err) => {
        console.error('Error al establecer la insignia:', err);
      });
    } 

    if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
      // App instalada
    }

    window.addEventListener('beforeinstallprompt', (e) => {
      if (isAndroid) {
        e.preventDefault();
        deferredPrompt = e;
      }
    });

    function installApp() {
      if (isAndroid && deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the A2HS prompt');
          } else {
            console.log('User dismissed the A2HS prompt');
          }
          deferredPrompt = null;
        });
      } else if (isIOS) {
        $('#iosInstallModal').modal('show');
      }
    };

</script>

</body>
</html>
