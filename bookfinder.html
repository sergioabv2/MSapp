<!DOCTYPE html>
<html lang="es" ng-app="pianoApp">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Piano Sheets Finder (AngularJS)</title>
  
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <style>
    :root {
      --primary-text: #2c2c2c;
      --secondary-text: #6c757d;
      --background-light: #fafafa;
      --border-color: #e9ecef;
      --brand-color: #3498db;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--background-light);
      color: #333;
      line-height: 1.6;
      margin: 0;
    }
    .search-section { padding: 2rem 1rem; text-align: center; background: linear-gradient(135deg, #f8f9fa 0%, var(--border-color) 100%); }
    .search-header-container { max-width: 900px; margin: 0 auto; }
    .search-title { font-size: 2rem; font-weight: 300; color: var(--primary-text); margin-bottom: 0.5rem; }
    .search-subtitle { font-size: 1rem; color: var(--secondary-text); margin-bottom: 2rem; }
    .search-container { max-width: 500px; margin: 0 auto 2rem; position: relative; }
    .search-input { width: 100%; padding: 0.875rem 1.25rem; font-size: 0.95rem; border: 2px solid var(--border-color); border-radius: 50px; outline: none; transition: all 0.3s ease; background-color: #fff; }
    .search-input:focus { border-color: var(--secondary-text); box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
    .search-btn { position: absolute; right: 6px; top: 6px; background-color: var(--primary-text); color: white; border: none; border-radius: 50px; padding: 0.625rem 1.25rem; cursor: pointer; transition: background-color 0.3s ease; font-size: 0.9rem; }
    .search-btn:hover { background-color: #495057; }
    .main-content { padding: 2rem 0; }
    .main-grid-container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; display: grid; grid-template-columns: 250px 1fr; gap: 2rem; }
    .filters-panel { background-color: #fff; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 15px rgba(0,0,0,0.06); align-self: start; }
    .filters-panel h4 { margin-top: 0; font-size: 1.2rem; color: var(--primary-text); }
    .filter-group { margin-bottom: 1.5rem; }
    .filter-label { font-weight: 600; display: block; margin-bottom: 0.75rem; color: var(--secondary-text); }
    .filter-option { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
    .filter-option label { color: #495057; cursor: pointer; }
    .filter-option input[type="radio"] { cursor: pointer; }
    .clear-filters-btn { width: 100%; padding: 0.75rem; border: 1px solid #ccc; background: #f1f1f1; cursor: pointer; border-radius: 6px; transition: background .2s; }
    .clear-filters-btn:hover { background: #e0e0e0; }
    .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
    .results-count { color: var(--secondary-text); font-size: 0.9rem; }
    .sort-select { padding: 0.5rem 0.875rem; border: 1px solid #dee2e6; border-radius: 4px; background-color: #fff; font-size: 0.85rem; color: var(--secondary-text); }
    .sheet-list { display: flex; flex-direction: column; gap: 1.5rem; }
    .sheet-item { display: flex; background-color: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 15px rgba(0,0,0,0.06); transition: all 0.3s ease; }
    .sheet-item:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
    .sheet-thumbnail { width: 100px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .sheet-icon { font-size: 2.5rem; color: #adb5bd; }
    .sheet-content { flex: 1; padding: 1.25rem; display: flex; flex-direction: column; justify-content: space-between; }
    .sheet-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.25rem; color: var(--primary-text); }
    .sheet-composer { color: var(--secondary-text); font-size: 0.9rem; margin-bottom: 0.5rem; }
    .sheet-meta { display: flex; align-items: center; justify-content: space-between; font-size: 0.8rem; color: #adb5bd; }
    .sheet-meta-left { display: flex; align-items: center; gap: 1rem; }
    .sheet-meta-item, .sheet-rating { display: flex; align-items: center; gap: 0.25rem; }
    .sheet-rating { color: #ffc107; }
    .sheet-actions { display: flex; flex-direction: column; gap: 0.5rem; padding: 1.25rem; border-left: 1px solid #f1f3f4; min-width: 130px; justify-content: center; align-items: center; }
    .price-tag { background-color: #495057; color: white; padding: 0.375rem 0.75rem; border-radius: 6px; font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; }
    .price-tag.free { background-color: #28a745; }
    .action-btn { width: 100%; border: none; border-radius: 6px; padding: 0.625rem 1rem; cursor: pointer; transition: background-color 0.3s ease; font-size: 0.8rem; font-weight: 500; color: white; }
    .preview-btn { background-color: #8e44ad; }
    .preview-btn:hover { background-color: #732d91; }
    .add-btn { background-color: var(--brand-color); }
    .add-btn:hover { background-color: #2980b9; }
    .no-results { text-align: center; padding: 3rem; color: var(--secondary-text); background: #fff; border-radius: 12px; }
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background-color: white; padding: 2rem; border-radius: 12px; max-width: 600px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; }
    .modal-close-btn { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 1.8rem; cursor: pointer; color: #aaa; }
    .preview-placeholder { text-align: center; padding: 2rem; background-color: #f9f9f9; border: 1px dashed #ccc; border-radius: 8px; margin-top: 1rem; }
    @media (max-width: 768px) {
      .main-grid-container { grid-template-columns: 1fr; }
      .sheet-item { flex-direction: column; }
      .sheet-actions { border-left: none; border-top: 1px solid #f1f3f4; }
    }
  </style>
</head>

<body ng-controller="SheetController">

  <section class="search-section">
    <div class="search-header-container">
      <h1 class="search-title">Partituras de Piano</h1>
      <p class="search-subtitle">Descubre obras clásicas y contemporáneas para piano</p>
      <div class="search-container">
        <input type="text" class="search-input" placeholder="Buscar por título o compositor..." ng-model="search.term">
        <button class="search-btn">Buscar</button>
      </div>
    </div>
  </section>

  <main class="main-content">
    <div class="main-grid-container">
      
      <aside class="filters-panel">
        <h4>Filtros</h4>
        <div class="filter-group">
          <label class="filter-label">Dificultad</label>
          <div class="filter-option">
            <input type="radio" id="diff_all" name="difficulty" value="all" ng-model="search.difficulty">
            <label for="diff_all">Todas</label>
          </div>
          <div class="filter-option">
            <input type="radio" id="diff_principiante" name="difficulty" value="Principiante" ng-model="search.difficulty">
            <label for="diff_principiante">Principiante</label>
          </div>
          <div class="filter-option">
            <input type="radio" id="diff_intermedio" name="difficulty" value="Intermedio" ng-model="search.difficulty">
            <label for="diff_intermedio">Intermedio</label>
          </div>
          <div class="filter-option">
            <input type="radio" id="diff_avanzado" name="difficulty" value="Avanzado" ng-model="search.difficulty">
            <label for="diff_avanzado">Avanzado</label>
          </div>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">Estilo</label>
          <div class="filter-option"><input type="radio" id="style_all" name="style" value="all" ng-model="search.style"><label for="style_all">Todos</label></div>
          <div class="filter-option"><input type="radio" id="style_clasico" name="style" value="Clásico" ng-model="search.style"><label for="style_clasico">Clásico</label></div>
          <div class="filter-option"><input type="radio" id="style_barroco" name="style" value="Barroco" ng-model="search.style"><label for="style_barroco">Barroco</label></div>
          <div class="filter-option"><input type="radio" id="style_romantico" name="style" value="Romántico" ng-model="search.style"><label for="style_romantico">Romántico</label></div>
          <div class="filter-option"><input type="radio" id="style_jazz" name="style" value="Jazz" ng-model="search.style"><label for="style_jazz">Jazz</label></div>
          <div class="filter-option"><input type="radio" id="style_moderno" name="style" value="Moderno" ng-model="search.style"><label for="style_moderno">Moderno</label></div>
        </div>
        
        <button class="clear-filters-btn" ng-click="clearFilters()">Limpiar Filtros</button>
      </aside>

      <div class="results-section">
        <div class="results-header">
          <span class="results-count">Mostrando {{(filtered = (allSheets | filter:customFilter)).length}} de {{allSheets.length}} partituras</span>
          <select class="sort-select" ng-model="sortOrder">
            <option value="title">A-Z</option>
            <option value="-rating">Mejor valoradas</option>
            <option value="composer">Compositor</option>
          </select>
        </div>

        <div class="sheet-list">
          <div ng-repeat="sheet in filtered | orderBy:sortOrder" class="sheet-item">
            <div class="sheet-thumbnail"><div class="sheet-icon">🎹</div></div>
            <div class="sheet-content">
              <div>
                <h3 class="sheet-title">{{sheet.title}}</h3>
                <p class="sheet-composer">{{sheet.composer}}</p>
              </div>
              <div class="sheet-meta">
                <div class="sheet-meta-left">
                  <div class="sheet-meta-item"><span>📄</span><span>{{sheet.pages}} páginas</span></div>
                  <div class="sheet-meta-item"><span>📅</span><span>{{sheet.date}}</span></div>
                  <div class="sheet-rating"><span>⭐</span><span>{{sheet.rating}}</span></div>
                </div>
              </div>
            </div>
            <div class="sheet-actions">
              <div class="price-tag" ng-class="{'free': sheet.isFree}">{{sheet.price}}</div>
              <button class="action-btn preview-btn" ng-click="openPreviewModal(sheet)">Preview</button>
              <button class="action-btn add-btn" ng-click="addToLibrary(sheet)">Agregar</button>
            </div>
          </div>
          
          <div ng-if="filtered.length === 0" class="no-results">
            <h3>No se encontraron resultados</h3>
            <p>Intenta cambiar tus filtros o término de búsqueda.</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div class="modal-overlay" ng-show="isModalVisible" ng-click="closePreviewModal()">
    <div class="modal-content" ng-click="$event.stopPropagation()">
      <button class="modal-close-btn" ng-click="closePreviewModal()">×</button>
      <div ng-if="sheetForPreview">
        <h2>{{sheetForPreview.title}}</h2>
        <p><strong>Compositor:</strong> {{sheetForPreview.composer}}</p>
        <hr>
        <div class="preview-placeholder">
          <h3>Vista Previa no disponible</h3>
          <p>El contenido del modal para la vista previa aparecerá aquí.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Se crea el módulo de AngularJS
    var app = angular.module('pianoApp', []);

    // Se crea el controlador que manejará toda la lógica
    app.controller('SheetController', function($scope) {
      
      // --- DATOS ---
      $scope.allSheets = [
        { title: "Für Elise", composer: "Ludwig van Beethoven", difficulty: "Principiante", style: "Clásico", pages: 4, date: "Mar 5, 2023", rating: 4.7, price: "GRATIS", isFree: true },
        { title: "Nocturne Op. 9 No. 2", composer: "Frédéric Chopin", difficulty: "Intermedio", style: "Romántico", pages: 9, date: "Oct 15, 2022", rating: 4.8, price: "$6.25", isFree: false },
        { title: "Preludio en Do Mayor BWV 846", composer: "Johann Sebastian Bach", difficulty: "Intermedio", style: "Barroco", pages: 3, date: "Jan 12, 2023", rating: 4.9, price: "$4.50", isFree: false },
        { title: "Claro de Luna (1er Movimiento)", composer: "Ludwig van Beethoven", difficulty: "Avanzado", style: "Clásico", pages: 7, date: "Feb 28, 2023", rating: 4.8, price: "$8.00", isFree: false },
        { title: "Take Five", composer: "Dave Brubeck", difficulty: "Intermedio", style: "Jazz", pages: 5, date: "Dec 8, 2022", rating: 4.6, price: "$7.25", isFree: false },
        { title: "Gymnopédie No. 1", composer: "Erik Satie", difficulty: "Principiante", style: "Moderno", pages: 3, date: "Nov 20, 2022", rating: 4.7, price: "GRATIS", isFree: true },
        { title: "Invención No. 1 en Do Mayor", composer: "Johann Sebastian Bach", difficulty: "Intermedio", style: "Barroco", pages: 2, date: "Sep 15, 2022", rating: 4.5, price: "$3.75", isFree: false },
        { title: "Liebestraum No. 3", composer: "Franz Liszt", difficulty: "Avanzado", style: "Romántico", pages: 8, date: "Aug 3, 2022", rating: 4.9, price: "$9.50", isFree: false }
      ];

      // --- ESTADO INICIAL DE FILTROS Y MODAL ---
      $scope.search = { term: '', difficulty: 'all', style: 'all' };
      $scope.sortOrder = 'title';
      $scope.isModalVisible = false;
      $scope.sheetForPreview = null;
      
      // --- FUNCIÓN DE FILTRADO PERSONALIZADO ---
      // Combina la búsqueda por texto y los filtros de radio button
      $scope.customFilter = function(sheet) {
        var searchTermMatch = !$scope.search.term || 
          sheet.title.toLowerCase().includes($scope.search.term.toLowerCase()) || 
          sheet.composer.toLowerCase().includes($scope.search.term.toLowerCase());

        var difficultyMatch = $scope.search.difficulty === 'all' || sheet.difficulty === $scope.search.difficulty;
        var styleMatch = $scope.search.style === 'all' || sheet.style === $scope.search.style;
        
        return searchTermMatch && difficultyMatch && styleMatch;
      };

      // --- FUNCIONES DE ACCIÓN ---
      $scope.clearFilters = function() {
          $scope.search = { term: '', difficulty: 'all', style: 'all' };
      };

      $scope.openPreviewModal = function(sheet) {
        $scope.sheetForPreview = sheet;
        $scope.isModalVisible = true;
      };

      $scope.closePreviewModal = function() {
        $scope.isModalVisible = false;
        $scope.sheetForPreview = null;
      };

      $scope.addToLibrary = function(sheet) {
        console.log(`"${sheet.title}" ha sido agregada a tu biblioteca.`);
        alert(`"${sheet.title}" se agregó a tu biblioteca!`);
      };
    });
  </script>

</body>
</html>
